=========================================
Database Setup and Configuration - Sat Feb 21 04:13:12 PM UTC 2026
=========================================

Generated secure database password: IQGeoXHKtCMFtrPRrjV012026!

Step 1: Setting up PostgreSQL database on 10.42.42.9...

Created SQL setup script: /tmp/setup_iqgeo_db.sql

Step 2: Executing SQL on database server via SSH as root...
Connecting to root@10.42.42.9...

could not change directory to "/root": Permission denied
DROP DATABASE
DROP ROLE
CREATE ROLE
CREATE DATABASE
GRANT
You are now connected to database "iqgeo" as user "postgres".
GRANT
GRANT
GRANT
ALTER DEFAULT PRIVILEGES
ALTER DEFAULT PRIVILEGES
           List of roles
 Role name | Attributes | Member of 
-----------+------------+-----------
 iqgeo     |            | {}

                            List of databases
 Name  | Owner | Encoding |   Collate   |    Ctype    | Access privileges 
-------+-------+----------+-------------+-------------+-------------------
 iqgeo | iqgeo | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =Tc/iqgeo        +
       |       |          |             |             | iqgeo=CTc/iqgeo
(1 row)

✅ Database and user created successfully

Step 3: Testing database connection...
All commands and output from this session will be recorded in container logs, including credentials and sensitive information passed through the command prompt.
If you don't see a command prompt, try pressing enter.
pod "test-db-connection-setup" deleted from iqgeo namespace
✅ Database connection test successful

Step 4: Updating ConfigMap with new database password...
configmap/iqgeo-platform-configmap patched
✅ ConfigMap updated with new credentials

Step 5: Verifying ConfigMap update...
MYW_DB_HOST: 10.42.42.9
MYW_DB_USERNAME: iqgeo
MYW_DB_PASSWORD: IQGeoXHKtC...
PGHOST: 10.42.42.9

Step 6: Deleting pod to restart with new credentials...
pod "iqgeo-platform-6bccdd6fd6-l8s89" deleted from iqgeo namespace
✅ Pod deleted, new pod will be created automatically

Step 7: Waiting 30 seconds for new pod to start...
Step 8: Checking pod status...
NAME                               READY   STATUS    RESTARTS     AGE
iqgeo-memcached-69d7fd799c-9t6sq   1/1     Running   0            42m
iqgeo-platform-6bccdd6fd6-kcvn8    0/1     Error     1 (8s ago)   42s

New pod: iqgeo-platform-6bccdd6fd6-kcvn8

Step 9: Checking init container logs...
10.42.42.9:5432 - accepting connections

Step 10: Waiting 60 more seconds for application startup...
Step 11: Checking application container logs...
Defaulted container "iqgeo-platform" out of: iqgeo-platform, init-ensure-db-connection (init)
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/util/deprecations.py", line 375, in warned
    return fn(*args, **kwargs)
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 618, in __new__
    with util.safe_reraise():
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 614, in __new__
    table._init(name, metadata, *args, **kw)
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 689, in _init
    self._autoload(
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/sql/schema.py", line 724, in _autoload
    conn_insp.reflect_table(
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/engine/reflection.py", line 774, in reflect_table
    for col_d in self.get_columns(
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/engine/reflection.py", line 497, in get_columns
    col_defs = self.dialect.get_columns(
  File "<string>", line 2, in get_columns
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/engine/reflection.py", line 55, in cache
    ret = fn(self, con, *args, **kw)
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/base.py", line 3902, in get_columns
    table_oid = self.get_table_oid(
  File "<string>", line 2, in get_table_oid
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/engine/reflection.py", line 55, in cache
    ret = fn(self, con, *args, **kw)
  File "/opt/iqgeo/platform/Externals/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/base.py", line 3782, in get_table_oid
    raise exc.NoSuchTableError(table_name)
sqlalchemy.exc.NoSuchTableError: setting
entrypoint process failed on entrypoint.d/300-ensure-database.sh

Step 12: Final pod status...
NAME                               READY   STATUS    RESTARTS      AGE
iqgeo-memcached-69d7fd799c-9t6sq   1/1     Running   0             43m
iqgeo-platform-6bccdd6fd6-kcvn8    0/1     Error     3 (32s ago)   102s

Pod Phase: Running
Pod Ready: False

⏳ Pod is Running but not Ready yet.
Run ./wait-for-ready.sh to continue monitoring

=========================================
DATABASE CREDENTIALS (SAVE THESE!):
=========================================
Host: 10.42.42.9
Port: 5432
Database: iqgeo
Username: iqgeo
Password: IQGeoXHKtCMFtrPRrjV012026!

⚠️  IMPORTANT: Save these credentials securely!
Update terraform.tfvars files with this password for future deployments:
  - /opt/iqgeo-onprem-deployment/terraform/terraform.tfvars (line 24)
  - /opt/iqgeo-application-deployment/terraform.tfvars (line 31)
=========================================

Setup Complete - Sat Feb 21 04:15:37 PM UTC 2026
=========================================
